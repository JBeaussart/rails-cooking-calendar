doctype html
html lang="fr"
  head
    title
      = content_for(:title) || "Cooking Calendar"
    meta name="viewport" content="width=device-width,initial-scale=1"
    meta name="apple-mobile-web-app-capable" content="yes"
    meta name="application-name" content="Cooking Calendar"
    meta name="mobile-web-app-capable" content="yes"
    = csrf_meta_tags
    = csp_meta_tag

    = yield :head

    link rel="icon" href="/icon.png" type="image/png"
    link rel="icon" href="/icon.svg" type="image/svg+xml"
    link rel="apple-touch-icon" href="/icon.png"
    
    / Google Fonts
    link rel="preconnect" href="https://fonts.googleapis.com"
    link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""
    link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&display=swap" rel="stylesheet"

    = stylesheet_link_tag :app, "data-turbo-track": "reload"
    = javascript_importmap_tags

  body.bg-cream.min-h-screen.font-sans
    / Navigation
    - if user_signed_in?
      nav.fixed.top-0.left-0.right-0.z-50.bg-white/80.backdrop-blur-lg.border-b.border-cream-dark
        .max-w-7xl.mx-auto.px-3.sm:px-6.lg:px-8
          .flex.items-center.justify-between.h-14.sm:h-16
            / Logo
            = link_to root_path, class: "flex items-center gap-2 sm:gap-3 group"
              .w-9.h-9.sm:w-10.sm:h-10.bg-gradient-to-br.from-terracotta.to-mustard.rounded-xl.flex.items-center.justify-center.shadow-md.group-hover:shadow-lg.transition-shadow
                span.text-lg.sm:text-xl ğŸ³
              span.font-display.font-bold.text-lg.sm:text-xl.text-navy.hidden.sm:block Cooking Calendar

            / Navigation principale (desktop only)
            .hidden.md:flex.items-center.gap-1
              = link_to root_path, class: "nav-link #{controller_name == 'meal_plans' ? 'nav-link-active' : ''}"
                span ğŸ—“ï¸
                span Planning
              = link_to recipes_path, class: "nav-link #{controller_name == 'recipes' ? 'nav-link-active' : ''}"
                span ğŸ“–
                span Recettes
              = link_to meal_events_path, class: "nav-link #{controller_name == 'meal_events' ? 'nav-link-active' : ''}"
                span ğŸ‰
                span Ã‰vÃ©nements

            / Right side actions
            .flex.items-center.gap-2.sm:gap-4
              / User menu (desktop)
              = link_to edit_user_registration_path, class: "hidden md:flex items-center gap-2 text-sm text-navy/70 hover:text-terracotta transition-colors"
                span.w-8.h-8.bg-sage/20.rounded-full.flex.items-center.justify-center.text-sage
                  | ğŸ‘¤
                span.truncate.max-w-32 = current_user.email
              = link_to "DÃ©connexion", destroy_user_session_path, data: { turbo_method: :delete }, class: "hidden md:inline-flex btn btn-ghost btn-sm"

              / Mobile menu button
              button.md:hidden.p-2.rounded-lg.hover:bg-cream.active:bg-cream-dark.transition-colors type="button" data-controller="mobile-menu" data-action="click->mobile-menu#toggle"
                svg.w-6.h-6.text-navy xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"
                  path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"

      / Mobile navigation (slide-in menu)
      #mobile-nav.hidden.md:hidden.fixed.inset-0.z-40.bg-cream/98.backdrop-blur-lg.pt-16
        .flex.flex-col.h-full.overflow-y-auto
          / Main nav links
          .flex.flex-col.gap-1.p-4
            = link_to root_path, class: "flex items-center gap-3 px-4 py-3 rounded-xl text-lg font-medium transition-colors #{controller_name == 'meal_plans' ? 'bg-terracotta text-white' : 'text-navy hover:bg-cream-dark'}"
              span.text-xl ğŸ—“ï¸
              span Planning
            = link_to recipes_path, class: "flex items-center gap-3 px-4 py-3 rounded-xl text-lg font-medium transition-colors #{controller_name == 'recipes' ? 'bg-terracotta text-white' : 'text-navy hover:bg-cream-dark'}"
              span.text-xl ğŸ“–
              span Recettes
            = link_to meal_events_path, class: "flex items-center gap-3 px-4 py-3 rounded-xl text-lg font-medium transition-colors #{controller_name == 'meal_events' ? 'bg-terracotta text-white' : 'text-navy hover:bg-cream-dark'}"
              span.text-xl ğŸ‰
              span Ã‰vÃ©nements

          / User section
          .mt-auto.p-4.border-t.border-cream-dark
            .flex.items-center.gap-3.px-4.py-3.mb-2
              .w-10.h-10.bg-sage/20.rounded-full.flex.items-center.justify-center
                | ğŸ‘¤
              .flex-1.min-w-0
                .text-sm.text-navy/60 ConnectÃ©
                .font-medium.text-navy.truncate = current_user.email
            = link_to edit_user_registration_path, class: "flex items-center gap-3 px-4 py-3 rounded-xl text-navy hover:bg-cream-dark transition-colors"
              span âš™ï¸
              span Mon compte
            = link_to destroy_user_session_path, data: { turbo_method: :delete }, class: "flex items-center gap-3 px-4 py-3 rounded-xl text-red-600 hover:bg-red-50 transition-colors"
              span ğŸšª
              span Se dÃ©connecter

    / Flash messages container (pour turbo_stream)
    #flash-messages

    / Flash messages classiques
    - if notice.present?
      .fixed.top-16.sm:top-20.left-4.right-4.sm:left-1/2.sm:-translate-x-1/2.sm:left-auto.sm:right-auto.sm:w-auto.z-50.animate-fade-in data-controller="auto-remove" data-auto-remove-delay-value="4000"
        .bg-sage.text-white.px-4.sm:px-6.py-3.rounded-xl.shadow-lg.flex.items-center.gap-3
          span âœ“
          span.text-sm.sm:text-base = notice

    - if alert.present?
      .fixed.top-16.sm:top-20.left-4.right-4.sm:left-1/2.sm:-translate-x-1/2.sm:left-auto.sm:right-auto.sm:w-auto.z-50.animate-fade-in data-controller="auto-remove" data-auto-remove-delay-value="5000"
        .bg-terracotta.text-white.px-4.sm:px-6.py-3.rounded-xl.shadow-lg.flex.items-center.gap-3
          span âš 
          span.text-sm.sm:text-base = alert

    / Main content
    main class="#{user_signed_in? ? 'pt-18 sm:pt-24 pb-8 sm:pb-12' : ''} min-h-screen"
      .max-w-7xl.mx-auto.px-3.sm:px-6.lg:px-8
        = yield

    / Footer (desktop only)
    - if user_signed_in?
      footer.hidden.sm:block.bg-white.border-t.border-cream-dark.mt-auto
        .max-w-7xl.mx-auto.px-4.sm:px-6.lg:px-8.py-8
          .flex.flex-col.sm:flex-row.items-center.justify-between.gap-4
            .flex.items-center.gap-2.text-navy/50.text-sm
              span ğŸ³
              span Cooking Calendar â€” Planifiez vos repas en famille
            .text-sm.text-navy/40
              | Fait avec â¤ï¸ pour les familles
